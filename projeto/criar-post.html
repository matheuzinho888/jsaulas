<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="../projeto/imgs_projeto/modelo.css" />
        <title>Criar Post</title>
    </head>
    <body>
        <aside class="menu-vertical">
            <a href="index.html">
            <img src="./imgs_projeto/10.png" alt="logotipo da biblioteca" class="logo" />
            </a>
            <nav>
                <ul>
                    <li><a href="index.html"><i class="bi bi-house"></i> INÍCIO</a></li>
                    <li><a href="criar-post.html"><i class="bi bi-folder-symlink"></i> CRIAR POST</a></li>
                    <li class="has-submenu">
                        <button class="submenu-toggle" id="sub"><i class="bi bi-folder2"></i> CATÁLOGO</button>
                        <ul class="submenu">
                            <li><a href="#" id="catal" ><i class="bi bi-bookmarks"></i> POSTS CRIADOS</a></li>
                            <li><a href="#" ><i class="bi bi-bookmark-star"></i> RECOMENDADOS</a></li>
                        </ul>
                    </li>
                    <li><a href="#" ><i class="bi bi-info-circle"></i> SOBRE</a></li>
                </ul>
                <div class="jj mt-3">
                    <a href="#"  aria-label="Ver GitHub dos desenvolvedores">
                    <i class="bi bi-github" style="color: white; font-size: 400%;"></i>
                    </a>
                    <br />
                    <button onclick="toggleDarkMode()" aria-label="Alternar modo escuro" style="background: none; border: none;">
                    <i class="bi bi-brightness-low" style="color: white; font-size: 410%;"></i>
                    </button>
                </div>
                <h1 style="color: white;"><i class="bi bi-instagram"></i>
                    <i class="bi bi-twitter-x"></i>
                    <i class="bi bi-whatsapp"></i>
                </h1>
            </nav>
        </aside>
        <main class="conteudo">
            <div id="Criar" class="secao">
                <div class="container mt-4">
                    <h2 class="mb-4">Criar Postagem</h2>
                    <form class="row g-3">
                        <div class="col-md-6">
                            <label for="nome_jogo" class="form-label">Nome do Jogo</label>
                            <input type="text" class="form-control" id="nome_jogo" name="nome_jogo" required autocomplete="off" />
                        </div>
                        <div class="col-md-6">
                            <label for="img_jogo" class="form-label">URL da Imagem de Capa</label>
                            <input type="url" class="form-control" id="img_jogo" name="img_jogo" placeholder="https://exemplo.com/imagem.jpg" autocomplete="off" />
                        </div>
                        <div class="col-12">
                            <label class="form-label">Avaliação</label>
                            <div class="classificacao" style="display: flex;flex-direction: row-reverse;justify-content: flex-end;">
                                <span class="estrela">&#9733;</span>
                                <span class="estrela">&#9733;</span>
                                <span class="estrela">&#9733;</span>
                                <span class="estrela">&#9733;</span>
                                <span class="estrela">&#9733;</span>
                            </div>
                        </div>
                        <div class="col-12">
                            <label for="floatingTextarea2" class="form-label">Comentários</label>
                            <textarea class="form-control" id="floatingTextarea2" placeholder="Deixe seu comentário" style="height: 100px;"></textarea>
                        </div>
                        <div class="col-12">
                            <button type="button" class="btn btn-primary" onclick="criarpost()">Postar</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>

        <div class="toast-container position-fixed bottom-0 end-0 p-3">
            <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true" style=" background-color: #63b963;">
                <div class="toast-header">
                    <!-- <img src="..." class="rounded me-2" alt="..."> -->
                    <strong class="me-auto">Post criado com sucesso!</strong>
                    <small >Criado neste momento</small>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body" id="tituloPost"></div>
            </div>
        </div>

        <script>
            function criarpost() {
                let nomejogo = document.getElementById('nome_jogo');
                let imgjogo = document.getElementById('img_jogo');
                
                if (!nomejogo.value || !imgjogo.value) {
                    alert("Por favor, preencha os campos de nome e imagem do jogo!");
                    return;
                }

                    const nome = nomejogo.value;
                    const sobre = "TESTE";
                    const capa = imgjogo.value;
                    const avaliacao = "0";
                    const comentarios = {}

                        // Atualiza os dados do jogo no array de jogos


                    // Verifica se todos os campos estão preenchidos
                    if (!nome || !sobre) {
                        alert("Por favor, preencha todos os campos!");
                        return;
                    }
                    

                    const novaJogo = {
                        nome,
                        sobre,
                        capa,
                        avaliacao,
                        comentarios
                    };                
                
                nomejogo.value = "";
                imgjogo.value = "";

                let jogos = JSON.parse(localStorage.getItem("jogos")) || [];
                jogos.push(novaJogo);

                // Salva novamente no localStorage
                localStorage.setItem("jogos", JSON.stringify(jogos));
                localStorage.removeItem("jogosPesquisados");
                window.location.href="criados.html"

                //PRECISA IR PARA A TELA DE CATALAGO - CRIADOS
            }
            
            
            function toggleDarkMode() {
              document.body.classList.toggle("dark-mode");
              const icone = document.getElementById("icone-tema");
              icone.src = document.body.classList.contains("dark-mode")
            }
            
            
            function avaliar(event) {
                const estrelas = document.querySelectorAll(".estrela");
                let selecionada = false;
                estrelas.forEach((estrela, index) => {
                if (estrela === event.target) {
                selecionada = true;
                }
                estrela.classList.toggle("selecionada", selecionada);
                });
            }
            
            document.querySelectorAll(".estrela").forEach(estrela => {
                estrela.addEventListener("click", avaliar);
            });

            
        </script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.min.js"></script>
        <script>
            function avisoPostCriado(tituloPost){
              let toastLiveExample = document.getElementById('liveToast');
              let toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample);
              document.getElementById("tituloPost").innerText = tituloPost;
              toastBootstrap.show();
            }
        </script>
        <script>
            document.querySelectorAll('.submenu-toggle').forEach(btn => {
              btn.addEventListener('click', () => {
                const submenu = btn.nextElementSibling;
                submenu.classList.toggle('show');
              });
            });
        </script>
    </body>
</html>