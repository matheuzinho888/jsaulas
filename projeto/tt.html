<!DOCTYPE html>
<html lang="pt-br">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
      <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="../projeto/modelo.css" />
      <link rel="stylesheet" href="../projeto/celular.css" media="screen and (max-width: 768px)">
      <title>Index: Biblioteca de Jogos</title>
   </head>
   <body>
   <div class="container-fluid">
      <div class="menu-mobile">
    <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#staticBackdrop" aria-controls="staticBackdrop">
        <i class="bi bi-list"></i>
      </button>
      
      <div class="offcanvas offcanvas-start" data-bs-backdrop="static" tabindex="-1" id="staticBackdrop" aria-labelledby="staticBackdropLabel" style="width: 237px;">
        <div class="offcanvas-header" style="background-color: #232539;">
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" style="color: white;
          background-color: white;"></button>
        </div>
        <div class="offcanvas-body" style="background-color: #232539;">
          <div>
            <aside class="menu-vertical" style="width: 220px;">
              <a href="index.html">
              <img src="./imgs_projeto/10.png" alt="logotipo da biblioteca" class="logo"/>
              </a>
              <nav>
                  <ul>
                      <li><a href="index.html"><i class="bi bi-house"></i> INÍCIO</a></li>
                      <li><a href="criar-post.html"><i class="bi bi-folder-symlink"></i> CRIAR</a></li>
                      <li class="has-submenu">
                          <button class="submenu-toggle" id="sub"><i class="bi bi-folder2"></i> CATÁLOGO</button>
                          <ul class="submenu">
                               <li><a href="./criados.html" id="catal" ><i class="bi bi-search"></i> PESQUISAR</a></li>
                              <li><a href="./tt.html"><i class="bi bi-bank"></i> MINHA BIBLIOTECA</a></li>
                          </ul>
                      </li>
                      <li><a href="./sobre.html" ><i class="bi bi-info-circle"></i> SOBRE</a></li>
                  </ul>
                  <div class="jj mt-3">
                      <a href="./github.html"  aria-label="Ver GitHub dos desenvolvedores">
                      <i class="bi bi-github" style="color: white; font-size: 400%;"></i>
                      </a>
                      <br />
                      <button onclick="toggleDarkMode()" aria-label="Alternar modo escuro" style="background: none; border: none;">
                      <i class="bi bi-brightness-low" style="color: white; font-size: 410%;"></i>
                      </button>
                  </div>
              </nav>
          </aside>
          </div>
        </div>
      </div>
      </div>

       <div class="menu-desktop">
            <aside class="menu-vertical" style="width: 220px;">
              <a href="index.html">
              <img src="./imgs_projeto/10.png" alt="logotipo da biblioteca" class="logo"/>
              </a>
              <nav>
                  <ul>
                      <li><a href="index.html"><i class="bi bi-house"></i> INÍCIO</a></li>
                      <li><a href="criar-post.html"><i class="bi bi-folder-symlink"></i> CRIAR</a></li>
                      <li class="has-submenu">
                          <button class="submenu-toggle" id="sub"><i class="bi bi-folder2"></i> CATÁLOGO</button>
                          <ul class="submenu">
                             <li><a href="./criados.html" id="catal" ><i class="bi bi-search"></i> PESQUISAR</a></li>
                          <li><a href="./tt.html"><i class="bi bi-bank"></i> MINHA BIBLIOTECA</a></li>
                          </ul>
                      </li>
                      <li><a href="./sobre.html" ><i class="bi bi-info-circle"></i> SOBRE</a></li>
                  </ul>
                  <div class="jj mt-3">
                      <a href="./github.html"  aria-label="Ver GitHub dos desenvolvedores">
                      <i class="bi bi-github" style="color: white; font-size: 400%;"></i>
                      </a>
                      <br />
                      <button onclick="toggleDarkMode()" aria-label="Alternar modo escuro" style="background: none; border: none;">
                      <i class="bi bi-brightness-low" style="color: white; font-size: 410%;"></i>
                      </button>
                  </div>
                 </nav>
          </aside>
         </div>
  </div>
         <main class="geral">
            <section id="minha-biblioteca" class="content-section">
            <h2 class="mb-4">Minha Biblioteca</h2>
            <div class="container" id="conteudo_jogos">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                <div class="alert alert-danger aviso" role="alert">
                    VOCÊ NÃO TEM NADA NA BIBLIOTECA!
                </div>
            </div>
            </div>

            </section>
         </main>
           <script>
        function carregarJogosTT() {
            let jogosTT = JSON.parse(localStorage.getItem("minha_biblioteca")) || [];
            let container = document.getElementById("listaJogosTT");
            let aviso = document.querySelector('.aviso');
            container.innerHTML = '';

            if (jogosTT.length === 0) {
                aviso.style.display = '';
            } else {
                aviso.style.display = 'none';
                jogosTT.forEach(jogo => {
                    let section = document.createElement("section");
                    section.classList.add("col", "jogo", "item2");
                    section.innerHTML = `
                        <div class="card shadow-sm">
                            <img src="${jogo.capa}" alt="foto-${jogo.nome}">
                            <h2 class="fw-normal text-center">${jogo.nome}</h2>
                            <div class="card-body">
                                <p class="card-text">${jogo.sobre}.</p>
                                <label class="form-label">Avaliação</label>
                                <div class="classificacao" style="display: flex;flex-direction: row;justify-content: flex-start;">
                                    ${[1,2,3,4,5].map(i => `<span class="estrela ${i <= parseInt(jogo.avaliacao) ? "selecionada" : "naoselecionada"}">&#9733;</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(section);
                });
            }
        }
        window.onload = carregarJogosTT;
    </script>
    
    
         
      <script src="carregarConteudo.js"></script>
     <script>
      
  window.onload = () => {
    const darkMode = localStorage.getItem("darkMode");
    if (darkMode === "enabled") {
      document.body.classList.add("dark-mode");
    }
  };

  function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
    const isDark = document.body.classList.contains("dark-mode");

    if (isDark) {
      localStorage.setItem("darkMode", "enabled");
    } else {
      localStorage.setItem("darkMode", "disabled");
    }
  }
</script>

    

      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.min.js"></script>
      <script>
      
      let minha_biblioteca2 = JSON.parse(localStorage.getItem("minha_biblioteca")) || [];

            if (minha_biblioteca2.length > 0) {
               for (let i = 0; i < minha_biblioteca2.length; i++) {
                  adicionarElemento(minha_biblioteca2[i], i);
               }
               document.getElementsByClassName("aviso")[0].classList.add("d-none");
            } else {
               document.getElementsByClassName("aviso")[0].classList.remove("d-none");
            }

      function adicionarElemento(jogo, pos) {
            const container = document.getElementById("conteudo_jogos");
            let divContainer = container.getElementsByClassName('row')[0];

            const sectionJogo = document.createElement("section");
            sectionJogo.setAttribute("id", `jogo-${pos}`);
            sectionJogo.classList.add("col", "jogo", "item2");

            sectionJogo.innerHTML = `
               <div class="card shadow-sm">                
                  <img src="${jogo.capa}" alt="foto-${jogo.nome}">
                  <h2 class="fw-normal text-center">${jogo.nome}</h2>
                  <div class="card-body">
                     <p class="card-text">${jogo.sobre}.</p>
                     <label class="form-label">Avaliação</label>
                     <div class="classificacao" style="display: flex;flex-direction: row;justify-content: flex-start;">
                        ${[1,2,3,4,5].map(i => `<span class="estrela ${i <= parseInt(jogo.avaliacao) ? "selecionada" : "naoselecionada"}">&#9733;</span>`).join('')}
                     </div>
                     <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">     
                         ${(minha_biblioteca.filter(j=> j.id == jogo.id).length >0) ? `<button class="btn btn-sm btn-outline-primary mt-2" onclick="removerJogoBiblioteca(${jogo.id},${pos})">Remover da Biblioteca</button>` : `<button class="btn btn-sm btn-outline-primary mt-2" onclick="adicionarJogoBiblioteca(${jogo.id},${pos})">Adicionar à Biblioteca</button>`}
                        </div>
                     </div>
                  </div>
               </div>`;

            divContainer.appendChild(sectionJogo);
         }            

  function removerJogoBiblioteca(id, posicao) {
    let minha_biblioteca = JSON.parse(localStorage.getItem("minha_biblioteca"));
    let jogos2 = [];
    minha_biblioteca.forEach(jogo => {
      if (jogo.id !== id) {
        jogos2.push(jogo);
      }
    });

    localStorage.setItem('minha_biblioteca', JSON.stringify(jogos2));
    window.location.reload();
  }

         
document.querySelectorAll('.submenu-toggle').forEach(btn => {
           btn.addEventListener('click', () => {
             const submenu = btn.nextElementSibling;
             submenu.classList.toggle('show');
           });
         });
      </script>
        
   </body>
</html>